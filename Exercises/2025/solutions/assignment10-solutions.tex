\documentclass[11pt]{article}

\usepackage{../ppackage}
\usepackage{bbm}
\usepackage{import}
\usepackage{booktabs}





\usepackage{tikz}
\usetikzlibrary{arrows.meta,patterns}
\usetikzlibrary{ipe} % ipe compatibility library

\usepackage{../../../Notes/tikzit}
\usepackage{../../../Notes/utf8math}

\input{../../../Notes/TIKZ/digraph.tikzstyles}



\usepackage{url}


\newcommand{\solution}{
\bigskip\noindent
	\textbf{Solution: \\}}
	


\DeclareMathOperator{\size}{size}
\DeclareMathOperator{\conv}{conv}
\newcommand{\SV}{\mathrm{SV}}
\newcommand{\bigO}{O}
\newcommand{\cut}{\mathrm{cut}}
\newcommand{\LLL}{\mathrm{LLL}}
\newcommand{\setR}{\mathbb{R}}
\newcommand{\setZ}{\mathbb{Z}}
\newcommand{\setQ}{\mathbb{Q}}
\newcommand{\setC}{\mathbb{C}}
\newcommand{\setN}{\mathbb{N}}
\newcommand{\wt}[1]{\widetilde{#1}}
\newcommand{\opt}{{\sc 0/1-opt}\xspace}
\newcommand{\aug}{{\sc 0/1-aug}\xspace}
\newcommand{\psep}{{\sc 0/1-psep}\xspace}
\newcommand{\sep}{{\sc 0/1-sep}\xspace}
\newcommand{\fopt}{{\sc 0/1-testopt\xspace} }

\newcommand{\hpp}{\mathrm{HPP}}
\newcommand{\nodes}{\mathcal{V}}
\newcommand{\vol}{\mathrm{vol}}
\newcommand{\diag}{\mathrm{diag}}
\newcommand{\arcs}{\mathcal{A}}
\newcommand{\edges}{\mathcal{E}}
\newcommand{\paths}{\mathscr{P}}
\newcommand{\cycles}{\mathcal{C}}




\newcommand{\K}{{\mathcal K}}
\newcommand{\A}{{A}}
\newcommand{\B}{{B}}
\newcommand{\T}{\mathscr{T}}
\newcommand{\eE}{\mathscr{E}}
\newcommand{\eS}{\mathscr{S}}
\newcommand{\eP}{\mathscr{P}}
\newcommand{\eM}{\mathscr{M}}



\newcommand{\transp}{^{\mathrm{T}}}

\newcommand{\smallmat}[1]{\left( \begin{smallmatrix} #1 \end{smallmatrix}\right)}

\newcommand{\mat}[1]{ \begin{pmatrix} #1 \end{pmatrix}}
\newcommand{\smat}[1]{ \big(\begin{smallmatrix} #1 \end{smallmatrix}\big)}

\newcommand{\pc}{\mathscr{P}}
\newcommand{\ob}{\mathscr{O}}
\newcommand{\odds}{\mathscr{W}}
\newcommand{\up}{\mathscr{U}}
\newcommand{\ef}{\mathscr{F}}
\newcommand{\eh}{\mathscr{H}}
\newcommand{\ev}{\mathscr{V}}
\newcommand{\ec}{\mathscr{C}}
\newcommand{\eu}{\mathscr{U}}

\newcommand{\lex}{\mathrm{lex}}

\renewcommand{\leq}{\leqslant}
\renewcommand{\geq}{\geqslant}









\newcommand{\linhull}{\mathrm{lin.hull}}
\newcommand{\affhull}{\mathrm{affine.hull}}
\newcommand{\charcone}{\mathrm{char.cone}}
\newcommand{\cone}{\mathrm{cone}}
\newcommand{\rank}{\mathrm{rank}}
\newcommand{\wb}[1]{\overline{#1}}



\usepackage{enumerate}

      
\institute{\'Ecole Polytechnique F\'ed\'erale de Lausanne}
\lecture{Discrete Optimization}
\faculty{Prof. Eisenbrand}
\term{Spring 2025}
\publishdate{April 14, 2025}
\duedate{ }
\problemset{Assignment~9}

\begin{document}
\makeheader

\begin{enumerate}[1)]

\item Let $M ∈ \setZ^{n×m}$ be totally unimodular. Prove that the following matrices are totally unimodular as well. 
\begin{enumerate}
\item $M^T$
\item $\begin{pmatrix} M & I_n \end{pmatrix}$
\item $\begin{pmatrix} M & -M \end{pmatrix}$
\item $M\cdot \begin{pmatrix} I_n− 2e_j e_j^T\end{pmatrix}$ for any $j \in [n]$. 
\end{enumerate}


\begin{solution}
\begin{enumerate}
\item Let $A$ be a square submatrix of $M^T$ . Then
$\det(A)= \det(A^T ) ∈ \{−1,0,1\}$
as $A^T$ is a square submatrix of $M$ and $M$ is totally unimodular.

\item Let $A$ be a square submatrix of $(M \ I_n)$. Let $a_1,..., a_k$ be the columns of $A$ that originate from $I_n$ . Hence, each of these columns has as most one 1-entry, the other entries are 0. Hence, using Laplace-expansion successively along these columns we get
that $|\det(A)| = | \det(A')|$ for some square submatrix of $M$ . Since $M$ is TU, this shows
$\det(A) ∈ \{−1,0,1\}$.

\item Let $A$ be a square submatrix of $\begin{pmatrix} M&  -M \end{pmatrix}$. Let $a_1,..., a_k$ be the columns of $A$ that
originate from $−M$. Let $A'$ be the matrix obtained from $A$ by multiplying $a_1,..., a_k$ with
$-1$. Hence
$| \det(A)| = | det(A')|$.
Now we distinguish two cases.
Case 1: $A'$ is (up to permutation of columns) a square submatrix of $M$ . Since $M$ is TU,
we have $\det(A') ∈ \{−1,0,1\}$.
Case 2: $A'$ has at least two identical columns. Hence $\det(A')= 0$.
We conclude that in both cases we have $\det(A) ∈ \{−1,0,1\}$.
\item Observe that $M\cdot (I_n− 2e_j e_j^T)$ is obtained from $M$ by multiplying one column with $-1$.
Thus, $M\cdot (I_n− 2e_j e_j^T)$ is (up to permutation of columns) a submatrix of  $\begin{pmatrix}M & -M\end{pmatrix}$. Thus this matrix is also TU. 
\end{enumerate}
\end{solution}


\item A family $\mathcal{F}$F of subsets of a finite groundset $E$ is laminar, if for all $C ,D ∈ \mathcal{F}$ , one of the following holds:
\begin{enumerate}
\item $C ∩ D = \emptyset$ 
\item $C ⊆ D$
\item $D ⊆ C$.
\end{enumerate}
Let $F_1$ and $F_2$ be two laminar families of the same groundset $E$ and consider its union
$F_1 ∪ F_2$. Define the $|F_1 ∪ F_2| × |E |$ adjacency matrix $A$ as follows: For $F ∈ F_1 ∪ F_2$ and $e ∈ E$
we have $A_{F,e} = 1$, if $e ∈ F$ and $A_{F,e} = 0$ otherwise.\\
Show that A is totally unimodular.

\begin{solution}
Let $F_1$ and $F_2$ be two laminar families on the same groundset $E$ , and $A$ the corresponding
adjacency matrix. Observe that every square submatrix of $A$ also is the adjacency matrix of
two laminar families: Removing a row from $A$ corresponds to deleting a set from the laminar
families. Removing a column from $A$ corresponds to removing an element of the ground-
set from all sets of the laminar families. Both operations preserve the structure of laminar
families.


For that reason, it is sufficient to show the following statement: Every square matrix $A$ that
is adjacency matrix of two laminar families has determinant $±1$ or $0$.
We will transform $A$ with elementary column operations as follows: Let $e ∈ E$ be an element from the groundset that is contained in at least two sets from $F_1$. Let $S_1,...,S_k$ be
the sets of $F_1$ with $e ∈ S_i$ . Using the properties of laminar families, we know that there is a
$l ∈ \{1,...,k\}$ such that $S_l ⊆ S_i$ for all $i= 1,...,k$. Redefine $S_i := S_i \setminus S_l$ for all $i\neq l$ . Observe
that $F_1$ is still a laminar family after this modification. Also observe that the operation of removing the set $S_l$ corresponds to subtraction the row $S_l$ from the other rows $S_i$ in the matrix
A.
Hence we can apply this transformation until each $e ∈ E$ is contained in at most one set of
$F_1$. Similarly we can apply this transformation to $F_2$ until each $e ∈ E$ is contained in at most
one set of $F_2$. Applying the corresponding elementary row operations to A yields a matrix
$A'$ with $\det(A)= \det(A')$.  $A'$ has the property that there are two disjoint subsets of rows, the
rows corresponding to $F_1$ and the rows corresponding to $F_2$, such that each column of $A'$
has at most one 1-entry in the rows of $F_1$ and at most one 1-entry in the rows of $F_2$. All other
entries are $0$.\\
Let $A''$ be the submatrix of $A'$ consisting only of the columns with two 1-entries. Note
that this is a node-edge incidence matrix of a bipartite graph. Hence $A''$ is TU. With Exercise 1.2 we get that $A'$ is TU. Hence $\det(A) ∈ \{−1,0,1\}$.
\end{solution}


\item Let $G$ be a graph and let $A$ be its node-edge incidence matrix. We have seen that if $G$ is
bipartite then $A$ is totally unimodular. Prove the converse, i.e., if $A$ is totally unimodular then $G$
is bipartite.

\begin{solution}
Let the incidence matrix of $G$ be totally unimodular and assume towards contradiction that $G$ is not bipartite. Then $G$ must contain a cycle of odd length. Let this cycle contain some vertices of $G$ $\{v_1, \hdots, v_{2k+1}\}$ for some $k \in \mathbb{N}$. Let the edges of this cycle be $\{e_1, \hdots, e_{2k+1}\}$. Now, consider the submatrix of $A$ indexed by $[v_1, \hdots, v_{2k+1}] \times [e_1, \hdots, e_{2k+1}]$.  
Then this submatrix of the cycle (up to permutation of the columns) looks as follows: \\

\begin{tabular}{l | l l l l l }
 & $e_1$ & $e_2$ &$e_3$ & $\hdots$ & $e_{2k+1}$ \\
 \midrule
$v_1$ & 1 & 0 & 0 &  $\hdots$ & 0 \ 1 \\
$v_2$ & 1 & 1 & 0 & $\hdots$ & 0 \ 0 \\
$v_3$ & 0 & 1 & 1 & $\hdots$ &  0 \ 0  \\
$\vdots$ & & $\ddots$ & & &  \\
$v_{2k+1}$ & 0 & 0 & 0 & $\hdots$ & 1 \ 1
\end{tabular}


Then since the number of rows and columns is odd, we can do row reduction and end with one row that has a value 2 giving the whole submatrix a determinant of 2. This means $A$ is not submodular, a contradiction. 
\end{solution}


\item Given a graph $G=(V,E)$, the spanning tree polytope $PST(G)$ is defined as follows:
$$PST (G) = \{x∈\setR^E : x(E(U)) ≤|U|−1 \ ∀U ⊂V, x(E) = |V|−1, x≥0\}.$$
We will show that each vertex of $PST(G)$ is integral (i.e. $PST (G)$ is the convex hull of the incidence
vectors of the spanning trees of G) by an uncrossing argument. 
Given $x^*$ a vertex of $PST (G)$, let $F= \{U ⊂V : x^*(E(U)) = |U|−1\}$.
\begin{enumerate}
\item Let $A,B ∈F$, show that $A∩B,A∪B ∈F$.
\item Show that if $L$ is a maximal laminar subfamily of $F$, then $span(L) = span(F)$ (where
$span(F) = span\{χ^{E(A)},A∈F\}$, and similarly for L).
\end{enumerate}



\begin{solution}
\begin{enumerate}
\item We have:
$$|A|−1 + |B|−1 = x*(E(A)) + x*(E(B)) ≤x*(E(A∪B)) + x*(E(A∩B))$$
where the inequality follows since the edges in $E(A∩B)$ are counted twice and each other
edge induced by $A$ or $B$ is also induced by $A∪B$. Now,
$$x*(E(A∪B)) + x*(E(A∩B)) ≤|A∪B|−1 + |A∩B|−1 = |A|−1 + |B|−1$$
hence all the inequalities hold with equality and in particular $x*(E(A∪B)) = |A∪B|−1$ and
$x*(E(A∩B)) = |A∩B|−1$.
\item  Similarly as in the proof seen before, for $A ∈ F$ we define $viol(A) = \{B ∈ L : A,B
\text{ are intersecting}\}$. Assume by contradiction that $span(L)$ is a strict subset of $span(F)$, and
let $A$ such that $χ^A ∈span(F) \setminus span(L)$ and $|viol(A)|$ is minimum. By maximality of $L$,
$|viol(A)|≥1$ otherwise $L∪A$ would be a larger laminar family contained in $F$. Hence let
$B ∈viol(A)$, we claim that $|viol(A∩B)|< |viol(A)|$. Indeed, let $C ∈viol(A∩B), C\neq B$,
we have that $C\setminus A∩B,A∩B\setminus C,A∩B∩C$ are non-empty. Moreover, $C ∈L$, hence either
$C ⊂B$, or $B ⊂C$ or $B∩C= \emptyset$. The last one is not possible as $A∩B∩C ⊂B∩C$. So assume
$C ⊂B$: then if $C ⊂A$, $C ⊂A∩B$, a contradiction to $C\setminus A∩B$ being non-empty. If $A⊂C$,
then $A⊂B$, a contradiction to $B ∈viol(A)$. If $A∩C= \emptyset$, then we get again a contradiction
to $A∩B ∩C$ being non-empty. Hence in this case $A,C$ are intersecting and the claim is
proved. In the case $B ⊂C$, the claim is proved similarly. With analogous arguments one
proves that $|viol(A∪B)|< |viol(A)|$. Now, by minimality of $|viol(A)|$, we must have that
$χ^{E(A∪B)},χ^{E(A∩B)} ∈span(L)$, but then $χ^{E(A)} = χ^{E(A∪B)} + χ^{E(A∩B)}−χ^{E(B)} ∈span(L)$, a
contradiction. (Notice that the equality holds because $A,B ∈F$ as seen in the proof of part
1).

\bigskip
We remark that we are now able to conclude that the vertices of $PST(G)$ are integral. In particular, $x*$ is the unique solution of the system $x(E(U)) = |U|−1$ for
\begin{align*}
 x(E(U)) = |U|−1 \quad &∀U ∈F \\
x_e = 0 \quad &∀e∈\bar{E}
\end{align*}
for some $\bar{E} ⊂E$. Using this argument, we can reduce the system to
\begin{align*}
x(E(U)) = |U|−1 & \quad ∀U ∈L \\
x_e = 0 & \quad ∀e∈\bar{E} 
\end{align*}
Now, the matrix associated to the system is totally unimodular, hence $x^*$ is an integer vector.
\end{enumerate}
\end{solution}






\end{enumerate}



  

\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
